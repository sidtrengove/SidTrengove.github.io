<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-4XRPD3TP16"></script>
		<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-4XRPD3TP16');
		</script>
		<title>P3: Working Papers</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<ul class="icons">
							<li><h1><a href="index.html">Home</a></h1></li>
							<li><h1><a href="https://www.linkedin.com/in/sidney-trengove/" class="icon brands fa-linkedin" target="_blank"></a></h1></li>
							<li><h1><a href="https://github.com/sidtrengove/PortfolioProjects" class="icon brands fa-github" target="_blank"></a></h1></li>
						</ul>
						<nav>
							<a href="#menu">Menu</a>
						</nav>
					</header>

				<!-- Menu -->
					<nav id="menu">
						<div class="inner">
							<h2>Menu</h2>
							<ul class="links">
								<li><a href="index.html#banner">Home</a></li>
								<li><a href="index.html#to-the-projects">Projects</a></li>
								<li><a href="index.html#footer">Contact</a></li>
								<li><a href="courses.html">Accreditations</a></li>
							</ul>
							<a href="#" class="close">Close</a>
						</div>
					</nav>

				<!-- Wrapper -->
					<section id="wrapper">
						<header>
							<div class="inner">
								<h2 class = "icon regular fa-file-code">Split</h2>
								<p>WORKING PAPERS: EXCEL & VBA</p>
							</div>

						</header>

						<!-- Content -->
						<div class="wrapper">
							<div class="inner">

								<p>Working Papers require being split if completed off the MyWorkingPapers platform to enable uplaod to seperate urls.</p>
								<h3 class="major">Initial Monthly Process (40mins)</h3>
								<ol>
									<li>Navigate to Sheet</li>
									<li>Right Click</li>
									<li>Move or Copy</li>
									<li>Create Copy</li>
									<li>File, Save As</li>
									<li>Choose file location & name</li>
									<li>Save</li>
									<li>Repeat for <u>every</u> Sheet in workings</li>
								</ol>

								<h3 class="major">New Monthly Process (1min)</h3>
								<ol>
									<li>Click button</li>
								</ol>
								<section >
									<h3 class="major icon solid fa-code-branch">CODE</h3>
									<p>Create a folder with date-time in name and save each Sheet as its Sheet name in xlsx format.</p>
									<pre><code>Sub SplitWorkbook()

Dim FileExtStr As String
Dim FileFormatNum As Long
Dim xWs As Worksheet
Dim xWb As Workbook
Dim xNWb As Workbook
Dim FolderName As String
Application.ScreenUpdating = False
Set xWb = Application.ThisWorkbook
 
    DateString = Format(Now, "dd-mm-yyyy hh-mm")
    FolderName = xWb.Path & "\" & Replace(xWb.Name, ".xlsm", " Split") & " " & DateString
 
    If Val(Application.Version) < 12 Then
        FileExtStr = ".xls": FileFormatNum = -4143
    Else
        Select Case xWb.FileFormat
            Case 51:
                FileExtStr = ".xlsx": FileFormatNum = 51
            Case 52:
                If Application.ActiveWorkbook.HasVBProject Then
                    FileExtStr = ".xlsx": FileFormatNum = 51
                Else
                    FileExtStr = ".xlsx": FileFormatNum = 51
                End If
            Case 56:
                FileExtStr = ".xls": FileFormatNum = 51
            Case Else:
                FileExtStr = ".xlsb": FileFormatNum = 51
            End Select
    End If
     
    MkDir FolderName
     
    For Each xWs In xWb.Worksheets
    On Error GoTo NErro
        If xWs.Visible = xlSheetVisible Then
        xWs.Select
        xWs.Copy
        xFile = FolderName & "\" & xWs.Name & FileExtStr
        Set xNWb = Application.Workbooks.Item(Application.Workbooks.Count)
        xNWb.SaveAs xFile, FileFormat:=FileFormatNum
        xNWb.Close False, xFile
        End If
NErro:
        xWb.Activate
    Next
     
        Sheet5.Select
        MsgBox "You can find the files in " & FolderName
        Application.ScreenUpdating = True


End Sub</code></pre>
								</section>

							</div>
						</div>

				</section>


				<!-- Footer -->
					<section id="footer">
						<div class="inner">
							<h2 class="major">Get in touch</h2>
							<ul class="contact">
								<li class="icon solid fa-envelope"><a href="mailto:SidTrengove@gmail.com">SidTrengove@gmail.com</a></li>
								<li class="icon solid fa-envelope"><a href="mailto:sidney.trengove@chiene.co.uk">Sidney.Trengove@chiene.co.uk</a></li>
								<li class="icon brands fa-linkedin"><a href="https://www.linkedin.com/in/sidney-trengove/" target="_blank">linkedin.com/in/sidney-trengove/</a></li>
							</ul>
							<ul class="copyright">
								<li>&copy; Untitled Inc. All rights reserved.</li><li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
							</ul>
						</div>
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>